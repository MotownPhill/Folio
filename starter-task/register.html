<!DOCTYPE html>
<html lang="en">

<head>

    <link href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/css/toastr.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/js/toastr.min.js"></script>
    <link href="https://pw.sabio.la/dist/all-site.css" rel="stylesheet" />
    <script src="https://pw.sabio.la/api/js/site"></script>
    <script src="https://unpkg.com/axios@0.19.2/dist/axios.min.js"></script>
    <script src="users.js"></script>
    <style>

    </style>
</head>

<body>
    <div class="mb-3">
        <label for="firstName" class="form-label">First Name</label>
        <input type="name" class="form-control" id="firstName" placeholder="First Name">
    </div>

    <div class="mb-3">
        <label for="lastName" class="form-label">Last Name</label>
        <input type="name" class="form-control" id="lastName" placeholder="Last Name">
    </div>

    <div class="mb-3">
        <label for="email" class="form-label">Email</label>
        <input type="email" class="form-control" id="email" placeholder="Email">
    </div>

    <div class="mb-3">
        <label for="password" class="form-label">Password</label>
        <input type="password" class="form-control" id="password" placeholder="Password">
    </div>

    <div class="mb-3">
        <label for="password" class="form-label">Password Confirm</label>
        <input type="password" class="form-control" id="passwordConfirm" placeholder="Password Confirm">
    </div>

    <div class="mb-3">
        <label for="avatar" class="form-label">Avatar Url</label>
        <input type="url" class="form-control" id="avatarUrl" placeholder="Avatar Url">
    </div>

    <div>
        <button onClick="registerUser()" type="button" class="btn btn-danger">Submit</button>
    </div>
</body>

<script>
    function startUp() {
        loginUser();
    }
    const registerUser = () => {

        const payload = {
            "firstName": $("#firstName").val(),
            "lastName": $("#lastName").val(),
            "email": $("#email").val(),
            "password": $("#password").val(),
            "passwordConfirm": $("#passwordConfirm").val(),
            "avatarUrl": $("#avatarUrl").val(),
            "tenantId": Math.random().toString(16).substr(2, 8)
        }

        userService.register(payload)
            .then(onRegisterSucces)
            .catch(onRegisterError)
    }

    const onRegisterSucces = (response) => {
        console.log(response)
        toastr.info("success")

        var url = "homepage.html";
        $(location).attr('href', url);
    }

    const onRegisterError = (response) => {
        console.warn(response)
    }

    const loginUser = () => {
        const payload = {
            "email": "maurice.g.washington@gmail.com",
            "password": "Kyocera6*",
            "tenantId": "U01TY0VT466"
        }

        const config = {
            method: "POST",
            url: "https://api.remotebootcamp.dev/api/users/login",
            data: payload,
            crossdomain: true,
            headers: { "Content-Type": "application/json" }
        };

        return axios(config)
            .then(function (response) {
                console.log(response)
            })
            .catch(function (response) {
                console.error(response)
            });
    }
</script>


</html>